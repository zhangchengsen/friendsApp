{"version":3,"sources":["webpack:///C:/Users/Ymtx/Desktop/friends-app/components/login/other_login.vue?59de","webpack:///C:/Users/Ymtx/Desktop/friends-app/components/login/other_login.vue?7294","webpack:///C:/Users/Ymtx/Desktop/friends-app/components/login/other_login.vue?f831","webpack:///C:/Users/Ymtx/Desktop/friends-app/components/login/other_login.vue?12ca","uni-app:///components/login/other_login.vue"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwH;AACxH;AAC+D;AACL;;;AAG1D;AACyK;AACzK,gBAAgB,kLAAU;AAC1B,EAAE,iFAAM;AACR,EAAE,sFAAM;AACR,EAAE,+FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,0FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAynB,CAAgB,8oBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACgB7oB;AACA;AACA;AACA,mBADA;AAEA,oBAFA,EADA,EADA;;;AAOA,MAPA,kBAOA;AACA;AACA,sBADA;;AAGA,GAXA;AAYA,SAZA,qBAYA;AACA;AACA,sBADA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAfA;;;;;;;;;AAwBA;AACA,8BADA;AAEA,qBAFA;AAGA,sBAHA;AAIA,4BAJA;;AAMA,SAlCA;AAmCA,OAtCA;AAuCA;AACA;AACA,OAzCA;;AA2CA,GAxDA;AAyDA;AACA;AACA,SAFA,iBAEA,IAFA,EAEA;AACA;AACA,uBADA;AAEA,mBAFA;;AAIA;AACA;AACA,yBADA;;;;AAKA;AACA;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;AAwBA;AACA,6BADA;AAEA,iCAFA;AAGA;AACA;AACA;AACA,iCADA;AAEA,+CAFA;AAGA,6BAHA;AAIA,mDAJA;AAKA,qDALA;;AAOA;AACA,aAbA;;;AAgBA,SAhDA;AAiDA;AACA;AACA;AACA,yBADA;AAEA,wBAFA;;AAIA,SAvDA;;AAyDA,KAjEA;AAkEA;AACA,cAnEA,sBAmEA,IAnEA,EAmEA;AACA;AACA,UADA,CACA;AACA;AACA;AACA;AACA;AACA;AACA,kBADA;;AAGA;AACA,uBADA;AAEA,sBAFA;;AAIA;AACA,OAdA,EAcA,KAdA,CAcA;AACA;AACA,OAhBA;AAiBA,KArFA;;AAuFA,iBAvFA,yBAuFA,MAvFA,EAuFA;AACA;AACA;AACA;AACA;AACA;AACA,2BADA;AAEA,gDAFA;AAGA,2BAHA;;AAKA;AACA;AACA;AACA;AACA,0BADA;AAEA;AACA;AACA,2BADA;AAEA,0BAFA;AAGA,uCAHA;AAIA,yCAJA;;AAMA,SATA;AAUA;AACA;AACA,SAZA;;AAcA,KAlHA;;AAoHA,WApHA,mBAoHA,OApHA,EAoHA;AACA;AACA,0BADA;AAEA,kCAFA;AAGA,oCAHA;AAIA,UAJA,CAIA;AACA;AACA;AACA,yCADA;AAEA,wBAFA;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA,kBADA;;AAGA;AACA,uBADA;AAEA,sBAFA;;AAIA,OAtBA;AAuBA,KA5IA,EAzDA,E","file":"components/login/other_login.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./other_login.vue?vue&type=template&id=d8136bae&\"\nvar renderjs\nimport script from \"./other_login.vue?vue&type=script&lang=js&\"\nexport * from \"./other_login.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/login/other_login.vue\"\nexport default component.exports","export * from \"-!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./other_login.vue?vue&type=template&id=d8136bae&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./other_login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./other_login.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"flex align-center px-5 py-3\">\r\n\t\t<!-- #ifdef APP-PLUS || MP-ALIPAY -->\r\n\t\t<view class=\"flex-1 flex align-center justify-center\"\r\n\t\tv-for=\"(item,index) in providerList\" :key=\"index\"\r\n\t\t@click=\"login(item)\">\r\n\t\t\t<view :class=\"item.icon + ' '+item.bgColor\" class=\"iconfont font-lg text-white flex align-center justify-center rounded-circle\" style=\"width: 100rpx;height: 100rpx;\"></view>\r\n\t\t</view>\r\n\t\t<!-- #endif -->\r\n\t\t<!-- #ifdef MP-WEIXIN -->\r\n\t\t<button type=\"primary\" open-type=\"getUserInfo\" @getuserinfo=\"mpGetUserInfo\">微信登录</button>\r\n\t\t<!-- #endif -->\r\n\t\t\r\n\t</view>\n</template>\n<script>\r\n\texport default {\r\n\t\tprops: {\r\n\t\t\tback: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false\r\n\t\t\t},\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tproviderList: []\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted(){\r\n\t\t\tuni.getProvider({\r\n\t\t\t\tservice: 'oauth',\r\n\t\t\t\tsuccess: (result) => {\r\n\t\t\t\t\tthis.providerList = result.provider.map((value) => {\r\n\t\t\t\t\t\tlet providerName = '';\r\n\t\t\t\t\t\tlet icon = ''\r\n\t\t\t\t\t\tlet bgColor = ''\r\n\t\t\t\t\t\tswitch (value) {\r\n\t\t\t\t\t\t\tcase 'weixin':\r\n\t\t\t\t\t\t\t\tproviderName = '微信登录'\r\n\t\t\t\t\t\t\t\ticon = 'icon-weixin'\r\n\t\t\t\t\t\t\t\tbgColor = 'bg-success'\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'qq':\r\n\t\t\t\t\t\t\t\tproviderName = 'QQ登录'\r\n\t\t\t\t\t\t\t\ticon = 'icon-QQ'\r\n\t\t\t\t\t\t\t\tbgColor = 'bg-primary'\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'sinaweibo':\r\n\t\t\t\t\t\t\t\tproviderName = '新浪微博登录'\r\n\t\t\t\t\t\t\t\ticon = 'icon-xinlangweibo'\r\n\t\t\t\t\t\t\t\tbgColor = 'bg-warning'\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t// #ifdef MP-ALIPAY\r\n\t\t\t\t\t\t\tcase 'alipay':\r\n\t\t\t\t\t\t\t\tproviderName = '支付宝登录';\r\n\t\t\t\t\t\t\t\ticon='changyonglogo30';\r\n\t\t\t\t\t\t\t\tbgColor = 'bg-primary'\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tname: providerName,\r\n\t\t\t\t\t\t\tid: value,\r\n\t\t\t\t\t\t\ticon:icon,\r\n\t\t\t\t\t\t\tbgColor:bgColor\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tfail: (error) => {\r\n\t\t\t\t\tconsole.log('获取登录通道失败', error);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 登录\r\n\t\t\tlogin(item) {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '登录中...',\r\n\t\t\t\t\tmask: false\r\n\t\t\t\t});\r\n\t\t\t\tconsole.log(item);\r\n\t\t\t\tuni.login({\r\n\t\t\t\t\tprovider: item.id,\r\n\t\t\t\t\t// #ifdef MP-ALIPAY\r\n\t\t\t\t\tscopes: 'auth_user',  //支付宝小程序需设置授权类型\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t   // 获取用户信息\r\n\t\t\t\t\t   // #ifdef MP-ALIPAY\r\n\t\t\t\t\t   this.MpLogin({\r\n\t\t\t\t\t\t   url:\"/alilogin\",\r\n\t\t\t\t\t\t   code:res.code\r\n\t\t\t\t\t   }).then(res2=>{\r\n\t\t\t\t\t\t   // 修改vuex的state,持久化存储\r\n\t\t\t\t\t\t   this.$store.commit('changeLoginStatus',this.$U.formatUserinfo(res2))\r\n\t\t\t\t\t\t   // 返回上一页\r\n\t\t\t\t\t\t   if(this.back){\r\n\t\t\t\t\t\t   \tuni.navigateBack({\r\n\t\t\t\t\t\t   \t\tdelta: 1\r\n\t\t\t\t\t\t   \t});\r\n\t\t\t\t\t\t   }\r\n\t\t\t\t\t\t   uni.showToast({\r\n\t\t\t\t\t\t   \ttitle: '登录成功',\r\n\t\t\t\t\t\t   \ticon: 'none'\r\n\t\t\t\t\t\t   });\r\n\t\t\t\t\t\t   uni.hideLoading()\r\n\t\t\t\t\t   }).catch(err=>{\r\n\t\t\t\t\t\t   uni.hideLoading()\r\n\t\t\t\t\t   })\r\n\t\t\t\t\t   // #endif\r\n\t\t\t\t\t   // #ifndef MP-ALIPAY\r\n\t\t\t\t\t   uni.getUserInfo({\r\n\t\t\t\t\t\t\t provider: item.id,\r\n\t\t\t\t\t\t\t withCredentials:true, \r\n\t\t\t\t\t\t\t success:(infoRes)=> {\r\n\t\t\t\t\t\t\t\t console.log(infoRes);\r\n\t\t\t\t\t\t\t\tlet obj = {\r\n\t\t\t\t\t\t\t\t\tprovider:item.id,\r\n\t\t\t\t\t\t\t\t\topenid:infoRes.userInfo.openId,\r\n\t\t\t\t\t\t\t\t\texpires_in:0,\r\n\t\t\t\t\t\t\t\t\tnickName:infoRes.userInfo.nickName,\r\n\t\t\t\t\t\t\t\t\tavatarUrl:infoRes.userInfo.avatarUrl,\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.loginEvent(obj)\r\n\t\t\t\t\t\t\t }\r\n\t\t\t\t\t   });\r\n\t\t\t\t\t   // #endif\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '登录失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t// 登录逻辑\r\n\t\t\tloginEvent(data){\r\n\t\t\t\tthis.$http.post('/user/otherlogin',data)\r\n\t\t\t\t.then(res=>{\r\n\t\t\t\t\t// 修改vuex的state,持久化存储\r\n\t\t\t\t\tthis.$store.commit('changeLoginStatus',this.$U.formatUserinfo(res))\r\n\t\t\t\t\tthis.$store.dispatch('openSocket')\r\n\t\t\t\t\t// 返回上一页\r\n\t\t\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\t\t\tdelta: 1\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '登录成功',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t}).catch(()=>{\r\n\t\t\t\t   uni.hideLoading()\r\n\t\t\t   })\r\n\t\t\t},\r\n\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\tmpGetUserInfo(result) {\r\n\t\t\t\tuni.showLoading({ title: '登录中...', mask: true });\r\n\t\t\t\t// 获取失败\r\n\t\t\t\tif (result.detail.errMsg !== 'getUserInfo:ok') {\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\ttitle: '获取用户信息失败',\r\n\t\t\t\t\t\tcontent: '错误原因' + result.detail.errMsg,\r\n\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tlet userinfo = result.detail.userInfo;\r\n\t\t\t\tuni.login({\r\n\t\t\t\t\tprovider:\"weixin\",\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tthis.MpLogin({\r\n\t\t\t\t\t\t\turl:\"/wxlogin\",\r\n\t\t\t\t\t\t\tcode:res.code,\r\n\t\t\t\t\t\t\tnickName:userinfo.nickName,\r\n\t\t\t\t\t\t\tavatarUrl:userinfo.avatarUrl\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// #endif\r\n\t\t\tMpLogin(options){\r\n\t\t\t\tthis.$http.post(options.url,{\r\n\t\t\t\t\tcode:options.code,\r\n\t\t\t\t\tnickName:options.nickName,\r\n\t\t\t\t\tavatarUrl:options.avatarUrl\r\n\t\t\t\t}).then(data=>{\r\n\t\t\t\t\tif(Array.isArray(data) && data.length == 0){\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '登录失败，请检查后端的微信小程序登录配置',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn \r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 修改vuex的state,持久化存储\r\n\t\t\t\t\tthis.$store.commit('changeLoginStatus',this.$U.formatUserinfo(data))\r\n\t\t\t\t\t// 返回上一页\r\n\t\t\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\t\t\tdelta: 1\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '登录成功',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t},\r\n\t}\n</script>\n<style>\r\n</style>\n"],"sourceRoot":""}