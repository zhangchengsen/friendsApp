{"version":3,"sources":["uni-app:///main.js",null,"webpack:///C:/Users/Ymtx/Desktop/friends-app/pages/search/search.vue?e166","webpack:///C:/Users/Ymtx/Desktop/friends-app/pages/search/search.vue?197a","webpack:///C:/Users/Ymtx/Desktop/friends-app/pages/search/search.vue?a063","uni-app:///pages/search/search.vue"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,+F;AACAA,UAAU,CAACC,eAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAmH;AACnH;AAC0D;AACL;;;AAGrD;AACyK;AACzK,gBAAgB,kLAAU;AAC1B,EAAE,4EAAM;AACR,EAAE,iFAAM;AACR,EAAE,0FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,qFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAonB,CAAgB,yoBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC6CxoB;AACA,UADA;AAEA;AACA;AACA;AACA,GALA;;AAOA,SAPA,qBAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,kBAPA;;AASA,OAVA;AAWA;AACA,GAtBA;;AAwBA,QAxBA,kBAwBA,CAxBA,EAwBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;AAUA,GA5CA;AA6CA;AACA,0BADA;AAEA,kBAFA;AAGA,kBAHA,EA7CA;;AAkDA,MAlDA,kBAkDA;AACA;AACA,eADA;AAEA,eAFA;AAGA,cAHA;AAIA,yBAJA;AAKA,kBALA;AAMA,oBANA;AAOA,aAPA;AAQA,wBARA;AASA,mBATA;AAUA,qBAVA;AAWA,oBAXA;;AAaA,GAhEA;AAiEA,eAjEA;AAkEA;AACA;AACA;AACA;AACA,GAtEA;AAuEA,mCAvEA,6CAuEA,CAvEA;AAwEA;AACA;AACA,GA1EA;AA2EA,0BA3EA,oCA2EA,CA3EA,EA2EA;AACA;AACA;AACA,uBAHA,CAGA;AACA;AACA,kBADA;AAEA,iBAFA;;AAIA;;;;;;;;AAQA,GA3FA;;AA6FA;AACA,UADA,kBACA,OADA,EACA;AACA;AACA;AACA;AACA;AACA;AACA,OALA;AAMA;AACA,qBADA;;AAGA,KAXA;AAYA,UAZA,oBAYA;AACA;AACA;AACA;AACA;AACA;AACA,8BADA;AAEA,uBAFA;AAGA,UAHA,CAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAFA,EADA;AAIA;AACA;AACA;AACA;AACA,gCADA;AAEA,+BAFA;AAGA,gCAHA;AAIA,2CAJA;AAKA,mCALA;AAMA,sBANA;;AAQA,WATA;AAUA,SAZA;;AAcA;AACA;AACA;AACA,sBADA;AAEA,+BAFA;AAGA,iCAHA;AAIA,kCAJA;AAKA,sDALA;AAMA,6BANA;;AAQA,WATA;AAUA;;AAEA;AACA;AACA;AACA;AACA,WAFA;AAGA;AACA;AACA;AACA,SARA;AASA;AACA;AACA;AACA;AACA;AACA,OApDA,EAoDA,KApDA,CAoDA;AACA;AACA;AACA;AACA,OAxDA;;AA0DA,KA3EA;AA4EA,YA5EA,oBA4EA,IA5EA,EA4EA;AACA,yBADA,CACA;AACA;AACA,oBADA;AAEA,mBAFA;;;AAKA;AACA;AACA;AACA;AACA,KAvFA;AAwFA,YAxFA,oBAwFA,EAxFA;AAyFA;;AAEA;AACA,qCADA;;AAGA,KA9FA,EA7FA,E","file":"pages/search/search.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/search/search.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./search.vue?vue&type=template&id=4cedc0c6&\"\nvar renderjs\nimport script from \"./search.vue?vue&type=script&lang=js&\"\nexport * from \"./search.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/search/search.vue\"\nexport default component.exports","export * from \"-!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./search.vue?vue&type=template&id=4cedc0c6&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./search.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./search.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view>\r\n\t\t<template v-if = \"!searchList.length && !demoU.length && !demoT.length \">\r\n\t\t\t\r\n\t\t\t<view class=\"p-2 font-md\" >\r\n\t\t\t\t搜索历史\r\n\t\t\t</view>\r\n\t\t\t<block v-for=\"(item,index) in historyList\" :key = \"index\">\r\n\t\t\t\t\r\n\t\t\t\t\t<view class=\"border d-inline-block mt-1 ml-2 p-1 font-sm \" style=\"border-radius: 8rpx;\" @click=\"clickHis(item)\">\r\n\t\t\t\t\t\t{{item}}\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t</block>\r\n\t\t\t\r\n\t\t\t\r\n\t\t</template>\r\n\t\t<template v-if=\"searchList.length > 0 && type == 'post' \">\r\n\t\t\t<commonList :userList = \"searchList\"></commonList>\r\n\t\t</template>\r\n\t\t<template v-if=\"type == 'user' \">\r\n\t\t\t<block v-for=\"(item,index) in  searchList\">\r\n\t\t\t\t<view class=\"\"  @click.stop = \"clickCpn(item.id)\">\r\n\t\t\t\t\t<cpn-cpn :item1=\"item\" type = \"search\"></cpn-cpn>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t</block>\r\n\t\t</template>\r\n\t\t<template v-if=\"type == 'topic' \">\r\n\t\t\t<block v-for=\"(item,index) in  searchList\">\r\n\t\t\t\t<topics class=\"pl-2\" :item=\"item\"></topics>\r\n\t\t\t</block>\r\n\t\t</template>\r\n\t\t<loadMore :load =\"loadMore\" v-if='searchList.length > 0'></loadMore>\r\n\t\t<nothing v-if=\"searchList.length == 0 && haveSearched\"></nothing>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport cpnCpn from \"@/components/msg/cpn-user-list-cpn.vue\"\r\n\timport topics from \"../../components/common/topics.vue\"\r\n\timport commonList from '../../components/common/common.vue'\r\n\texport default {\r\n\t\tonUnload()\r\n\t\t{\r\n\t\t\tif(this.type == \"post\")\r\n\t\t\tuni.$off('changeSupportOrFollow',((e)=>{}))\r\n\t\t}\r\n\t\t,\r\n\t\tmounted(){\r\n\t\t\tif(this.type == \"post\")\r\n\t\t\t{\r\n\t\t\t\tuni.$on('changeSupportOrFollow',(e)=>{\r\n\t\t\t\t\tswitch (e.type) {\r\n\t\t\t\t\t\tcase 'follow':\r\n\t\t\t\t\t\t\tthis.follow(e.data.user_id)\r\n\t\t\t\t\t\t\tbreak\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tthis.admire(e.data)\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tonLoad(e) {\r\n\t\t\tthis.type = e.type\r\n\t\t\tlet pageTitle = ''\r\n\t\t\tlet list = uni.getStorageSync('history')\r\n\t\t\tif(list)\r\n\t\t\t{\r\n\t\t\t\tthis.historyList = JSON.parse(list)\r\n\t\t\t}\r\n\t\t\tif(this.type == 'post') pageTitle = '帖子'\r\n\t\t\telse if(this.type == 'topic') pageTitle = \"话题\"\r\n\t\t\telse pageTitle = \"用户\"\r\n\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\tconst currentWebview = this.$mp.page.$getAppWebview()\r\n\t\t\t\tlet tn = currentWebview.getStyle().titleNView\r\n\t\t\t\ttn.searchInput.placeholder = '搜索' + pageTitle \r\n\t\t\t\tcurrentWebview.setStyle({\r\n\t\t\t\t\ttitleNView:tn\r\n\t\t\t\t})\r\n\t\t\t// #endif\r\n\t\t\t\r\n\t\t},\r\n\t\tcomponents:{\r\n\t\t\tcommonList,\r\n\t\t\tcpnCpn,\r\n\t\t\ttopics\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn{\r\n\t\t\t\tdemoU:[],\r\n\t\t\t\tdemoT:[],\r\n\t\t\t\ttype:'',\r\n\t\t\t\thaveSearched:false,\r\n\t\t\t\tinputVal:\"\",\r\n\t\t\t\tsearchList:[],\r\n\t\t\t\tpage:1,\r\n\t\t\t\tloadMore:'上拉加载更多',\r\n\t\t\t\tpreSearch:'',\r\n\t\t\t\thistoryList:[],\r\n\t\t\t\tnothing:false\r\n\t\t\t}\r\n\t\t},\r\n\t\tonReachBottom()\t\t\t\r\n\t\t{\r\n\t\t\tif(this.loadMore == '没有更多了') return\r\n\t\t\tthis.loadMore = '加载中...'\r\n\t\t\tthis.search()\r\n\t\t},\r\n\t\tonNavigationBarSearchInputChanged(e)\r\n\t\t{\r\n\t\t    this.inputVal = e.text\r\n\t\t},\r\n\t\tonNavigationBarButtonTap(e) {\r\n\t\t    //收起键盘\r\n\t\t\t\t//请求搜索\r\n\t\t\tuni.hideKeyboard()\t//隐藏软键盘\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle:\"加载中\",\r\n\t\t\t\tmask:false    \r\n\t\t\t})\r\n\t\t\tthis.search()\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t   \r\n\t\t}\r\n\t\t,\r\n\t\tmethods:{\r\n\t\t\tfollow(user_id) {\r\n\t\t\t\tthis.searchList.forEach((v)=>{\r\n\t\t\t\t\tif(v.user_id === user_id)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tv.follow = true\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle:\"关注成功\"\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t search () {\r\n\t\t\t\tlet isRefresh = this.inputVal == this.preSearch ? true : false\r\n\t\t\t\tthis.haveSearched = true\r\n\t\t\t\tif(!isRefresh) this.page = 1\r\n\t\t\t\tlet type = this.type\r\n\t\t\t\tthis.$http.post(`/search/${type}`,{\r\n\t\t\t\t\tkeyword:this.inputVal,\r\n\t\t\t\t\tpage:this.page\r\n\t\t\t\t}).then(res=>{\r\n\t\t\t\t\tif(res.list.length < 1) this.nothing = true\r\n\t\t\t\t\telse this.nothing = false\r\n\t\t\t\t\tlet list = []\r\n\t\t\t\t\tif(this.type == 'post')\r\n\t\t\t\t\t list = res.list.map(v=>{\r\n\t\t\t\t\t\treturn this.$U.helper(v)\r\n\t\t\t\t\t})\r\n\t\t\t\t\telse if(this.type == 'topic')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlist = res.list.map(v=>{\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t topicName:v.title,\r\n\t\t\t\t\t\t\t\t topicDesc:v.desc,\r\n\t\t\t\t\t\t\t\t news:v.post_count,\r\n\t\t\t\t\t\t\t\t news_today:v.todaypost_count,\r\n\t\t\t\t\t\t\t\t title_pic:v.titlepic,\r\n\t\t\t\t\t\t\t\t id:v.id\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlist = res.list.map(v=>{\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\tid:v.id,\r\n\t\t\t\t\t\t\t\t\tavatar:v.userpic,\r\n\t\t\t\t\t\t\t\t\tsex:v.userinfo.sex,\r\n\t\t\t\t\t\t\t\t\tusername:v.username,\r\n\t\t\t\t\t\t\t\t\tage:v.userinfo.age ? v.userinfo.age : 0 ,\r\n\t\t\t\t\t\t\t\t\tisFollow:false\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(!isRefresh) \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.historyList = this.historyList.filter(v=> {\r\n\t\t\t\t\t\t\treturn v !=this.inputVal\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tthis.historyList.unshift(this.inputVal)\r\n\t\t\t\t\t\tthis.searchList = list\r\n\t\t\t\t\t\tuni.setStorageSync('history',JSON.stringify(this.historyList))\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse this.searchList = [...this.searchList,...list]\r\n\t\t\t\t\tthis.page ++\r\n\t\t\t\t\tthis.preSearch = this.inputVal\r\n\t\t\t\t\tif(list.length < 10) this.loadMore = '没有更多了'\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t}).catch(err=>{\r\n\t\t\t\t\tconsole.log(err.message)\r\n\t\t\t\t\tthis.page--;\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\tclickHis(item) {\r\n\t\t\t\tuni.hideKeyboard()\t//隐藏软键盘\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t    title:\"加载中\",\r\n\t\t\t\t    mask:false    \r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\t    uni.hideLoading()\r\n\t\t\t\t    //\t拿到数据之后隐藏\r\n\t\t\t\tthis.inputVal = item\r\n\t\t\t\tthis.search()                                   \r\n\t\t\t},\r\n\t\t\tclickCpn(id)\r\n\t\t\t{\r\n\t\t\t\t\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl:'../zone/zone?uid=' + id\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\t\r\n\t\t},\r\n\t\t\r\n\t}\r\n</script>\r\n\r\n<style>\r\n</style>\r\n"],"sourceRoot":""}