{"version":3,"sources":["uni-app:///main.js","webpack:///C:/Users/Ymtx/Desktop/friends-app/pages/user-msg/user-msg.vue?5081","webpack:///C:/Users/Ymtx/Desktop/friends-app/pages/user-msg/user-msg.vue?3433","webpack:///C:/Users/Ymtx/Desktop/friends-app/pages/user-msg/user-msg.vue?8add","webpack:///C:/Users/Ymtx/Desktop/friends-app/pages/user-msg/user-msg.vue?537e","uni-app:///pages/user-msg/user-msg.vue"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,oG;AACAA,UAAU,CAACC,gBAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAqH;AACrH;AAC4D;AACL;;;AAGvD;AACyK;AACzK,gBAAgB,kLAAU;AAC1B,EAAE,8EAAM;AACR,EAAE,mFAAM;AACR,EAAE,4FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,uFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAsnB,CAAgB,2oBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC+B1oB;AACA;AACA,wBADA;AAEA,0BAFA;AAGA,4BAHA,EADA;;AAMA,QANA,kBAMA,CANA;AAOA;AACA;AACA;AACA;AACA,gBADA;;AAGA;AACA,wBADA;AAEA,oBAFA;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAHA;AAIA;AACA;AACA;AACA;AACA,mBADA;AAEA,qBAFA;;AAIA;AACA,KARA;AASA;AACA;AACA;AACA;AACA,OAJA;;AAMA;AACA;AACA,GA3CA;AA4CA,SA5CA,qBA4CA;AACA;AACA,GA9CA;AA+CA,eA/CA,2BA+CA;AACA;AACA;AACA,GAlDA;;AAoDA,MApDA,kBAoDA;AACA;AACA,kBADA;AAEA,kBAFA;AAGA,oBAHA;;AAKA,GA1DA;AA2DA;AACA;AACA,cAFA,sBAEA,CAFA,EAEA;AACA;AACA;AACA;AACA,OAHA,EAGA,KAHA,CAGA;AACA;AACA,OALA;AAMA,KATA;AAUA;AACA,YAXA,sBAWA;AACA;AACA;AACA;AACA,OAHA,EAGA,GAHA;;AAKA,KAjBA;AAkBA;AACA,QAnBA,gBAmBA,CAnBA,EAmBA;AACA,6CADA;AAEA,4CAFA;AAGA;AACA,yCADA;AAEA,gCAFA,GAHA,SAGA,MAHA;;AAOA;AACA,6BADA;AAEA,oBAFA,CAEA;AACA;AACA,gCADA;AAEA,8BAFA;;AAIA,iBAPA;AAQA;AACA;AACA;AAjBA,2EAkBA,CArCA;;AAuCA;AACA,WAxCA,qBAwCA;AACA;AACA,gBADA;;AAGA,KA5CA;AA6CA,WA7CA,qBA6CA;AACA;AACA;AACA;AACA;AACA,iEADA;AAEA,0BAFA;AAGA,uBAHA;AAIA,sBAJA;AAKA,kCALA;AAMA,oBANA;;AAQA;AACA;AACA;AACA;AACA;AACA,6CADA;AAEA,0BAFA;AAGA,4BAHA;AAIA,sBAJA;AAKA,kCALA;AAMA,oBANA;;AAQA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KA9EA,EA3DA,E","file":"pages/user-msg/user-msg.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/user-msg/user-msg.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./user-msg.vue?vue&type=template&id=c67c7534&\"\nvar renderjs\nimport script from \"./user-msg.vue?vue&type=script&lang=js&\"\nexport * from \"./user-msg.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/user-msg/user-msg.vue\"\nexport default component.exports","export * from \"-!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./user-msg.vue?vue&type=template&id=c67c7534&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./user-msg.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\XB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./user-msg.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"m-3\">\r\n\t\t<!-- 导航头部 -->\r\n\t\t<uni-nav-bar style=\"height: 100rpx;\" class=\"\">\r\n\t\t\t<text slot=\"left\" class=\"iconfont icon-fanhui text-center \"  @click=\"navBack\"></text>\r\n\t\t\t<view class=\"w-100 flex align-center justify-center\">\r\n\t\t\t\t消息\r\n\t\t\t</view>\r\n\t\t\t<text slot = \"right\" class=\"iconfont icon-geren\"></text>\r\n\t\t</uni-nav-bar>\r\n\t\t<!-- scroll消息内容 -->\r\n\t\t<scroll-view scroll-y=\"true\"   class=\"mt-1\" style=\"position: absolute;top: 100rpx;left: 0;right: 0;bottom: 100rpx;\" scroll-with-animation=\"true\" :scroll-into-view=\"scrollInto\">\r\n\t\t\t<block v-for=\"(item,index) in chatList\" :key=\"index\">\r\n\t\t\t\t<!-- 消息组件 -->\r\n\t\t\t\t<view :id = '\"tab\" + index'>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<cpn-msg-chat  :item = \"item\" :preTime = \" index ? chatList[index - 1].create_time: 0  \" ></cpn-msg-chat>\t\t\r\n\t\t\t\t</view>\r\n\t\t\t</block>\r\n\t\t\t\r\n\t\t\t\r\n\t\t</scroll-view>\r\n\t\t<!-- 底部发送消息 -->\r\n\t\t<bottom-input @send = \"send\"></bottom-input>\r\n\t</view>\n</template>\n\n<script>\r\n\timport bottomInput from '@/components/msg/bottom_input.vue'\r\n\timport cpnMsgChat from '@/components/msg/cpn-msg-chat.vue'\r\n\timport uniNavBar from '@/static/uni-components/uni-nav-bar/uni-nav-bar.vue'\r\n\texport default{\r\n\t\tcomponents:{\r\n\t\t\tuniNavBar,\r\n\t\t\tcpnMsgChat,\r\n\t\t\tbottomInput\r\n\t\t},\r\n\t\tonLoad(e)\r\n\t\t{\r\n\t\t\tconsole.log(e)\r\n\t\t\tif(!e.user){\r\n\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\tdelta:1\r\n\t\t\t\t});\r\n\t\t\t\treturn uni.showToast({\r\n\t\t\t\t\ttitle:'聊天对象不存在',\r\n\t\t\t\t\ticon:'none'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tlet ToUser = JSON.parse(e.user)\r\n\t\t\t//  创建聊天对象\r\n\t\t\tthis.$store.commit('createToUser',ToUser)\r\n\t\t\t// 获取当前用户的聊天记录\r\n\t\t\tthis.$store.dispatch('getChatDetailToUser').then(list=>{\r\n\t\t\t\tconsole.log(list)\r\n\t\t\t\tthis.chatList = list\r\n\t\t\t})\r\n\t\t\tuni.$on('UserChat',(res)=>{\r\n\t\t\t\tconsole.log('user-msg对话页 接受到聊天信息',res)\r\n\t\t\t\tif(res.from_id == ToUser.user_id){\r\n\t\t\t\t\tthis.renderPage({\r\n\t\t\t\t\t\tdata:res,\r\n\t\t\t\t\t\tsend:false\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tuni.getSystemInfo({\r\n\t\t\t\tsuccess:(res)=>{\r\n\t\t\t\t\tthis.scrollH = res.windowHeight - uni.upx2px(160) - 44\r\n\t\t\t\t\tconsole.log(this.scrollH)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tthis.getData()\r\n\t\t\tthis.toButtom()\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tthis.toButtom()\r\n\t\t},\r\n\t\tbeforeDestroy(){\r\n\t\t\tthis.$store.commit('closeToUser')\r\n\t\t\tuni.$off('UserChat',()=>{})\r\n\t\t}\r\n\t\t,\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tinputVal:'',\r\n\t\t\t\tchatList:[],\r\n\t\t\t\tscrollInto:\"\"\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods:{\r\n\t\t\t// 渲染\r\n\t\t\trenderPage(e) {\r\n\t\t\t\tthis.$store.dispatch('formatChatDetailObject',e).then(msg=>{\r\n\t\t\t\t\tthis.chatList.push(msg)\r\n\t\t\t\t\tthis.toButtom()\r\n\t\t\t\t}).catch(err=>{\r\n\t\t\t\t\tconsole.log('user-msg $on',err.message)\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 滚动\r\n\t\t\ttoButtom() {\r\n\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\tif(this.chatList.length < 1) return\r\n\t\t\t\t\tthis.scrollInto = 'tab' + (this.chatList.length - 1)\r\n\t\t\t\t},600)\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\t// 发送信息\r\n\t\t\tasync send(e) {\r\n\t\t\t\tthis.inputVal = e.inputVal\r\n\t\t\t\tif(this.inputVal.trim() == '') return \r\n\t\t\t\tlet result = await this.$store.dispatch('sendChatMessage',{\r\n\t\t\t\t\tdata:this.inputVal,\r\n\t\t\t\t\ttype:'text'\r\n\t\t\t\t}) \r\n\t\t\t\tthis.$http.post('/chat/send',result,{\r\n\t\t\t\t\ttoken:true\r\n\t\t\t\t}).then(res=>{\r\n\t\t\t\t\tthis.renderPage({\r\n\t\t\t\t\t\tdata:result,\r\n\t\t\t\t\t\tsend:true\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\t// this.chatList.push(obj)\r\n\t\t\t\tthis.inputVal = ''\r\n\t\t\t\t// this.toButtom()\r\n\t\t\t}\r\n\t\t\t,\r\n\t\t\t// 返回\r\n\t\t\tnavBack() {\r\n\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\tdelta:1\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tgetData() {\r\n\t\t\t\tlet arr = []\r\n\t\t\t\tfor(var i = 0 ; i < 2 ; i ++)\r\n\t\t\t\t{\r\n\t\t\t\t\tlet obj = {\r\n\t\t\t\t\t\tavatar:\"../../static/images/20210508440280_qMJDnX.jpg\",\r\n\t\t\t\t\t\tusername:\"ymtx\",\r\n\t\t\t\t\t\tdata:\"hello\",\r\n\t\t\t\t\t\ttype:\"text\",\r\n\t\t\t\t\t\tcreate_time:15070783530,\r\n\t\t\t\t\t\tuser_id:0\r\n\t\t\t\t\t}\r\n\t\t\t\t\tarr.push(obj)\r\n\t\t\t\t}\r\n\t\t\t\tfor(var i = 0 ; i < 3 ; i ++)\r\n\t\t\t\t{\r\n\t\t\t\t\tlet obj = {\r\n\t\t\t\t\t\tavatar:\"../../static/images/2.jpg\",\r\n\t\t\t\t\t\tusername:\"IT黑马\",\r\n\t\t\t\t\t\tdata:\"收到等我一下下下下下\",\r\n\t\t\t\t\t\ttype:\"text\",\r\n\t\t\t\t\t\tcreate_time:15070783530,\r\n\t\t\t\t\t\tuser_id:1\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(i == 2) \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tobj.create_time = 15090783530\r\n\t\t\t\t\t\tobj.data = '啊哈哈哈哈哈 久等了'\r\n\t\t\t\t\t}\r\n\t\t\t\t\tarr.push(obj)\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\tthis.chatList = arr\r\n\t\t\t}\r\n\t\t}\r\n\t}\n</script>\n\n<style>\n</style>\n"],"sourceRoot":""}